# Multi-Repository Code Explorer
# Explore code across local directories and GitHub repos.
#
# Run:
#   npx -y @probelabs/visor@latest run examples/multi-repo.yaml --message "How does intent classification work?"

version: "1.0"

imports:
  - https://raw.githubusercontent.com/probelabs/visor-ee/master/workflows/assistant.yaml

checks:
  chat:
    type: workflow
    workflow: assistant
    assume: ["true"]
    args:
      question: "{{ conversation.current.text }}"
      system_prompt: "You are a code exploration assistant. Help developers understand codebases."

      intents:
        - id: chat
          description: General conversation
        - id: code_help
          description: Questions about code, implementation, or architecture

      skills:
        - id: code-explorer
          description: |
            needs codebase exploration, code search, implementation details,
            or wants to understand how something works in the code
          knowledge: |
            You can search across multiple repositories.
            Always mention which repo each file is from and provide line numbers.
          tools:
            code-explorer:
              workflow: code-talk
              inputs:
                projects:
                  # Local: this quickstart repo
                  - name: quickstart
                    path: .
                    description: Visor quickstart (assistant config, docs, examples)

                  # GitHub: the Visor engine
                  - name: visor
                    repo: probelabs/visor
                    description: Visor runtime, CLI, and core workflows

                  # Add your own repos:
                  # - name: backend
                  #   path: /home/user/projects/backend
                  #   description: Backend API server
                  # - name: private-repo
                  #   repo: myorg/private-repo    # requires GITHUB_TOKEN in .env
                  #   ref: main
                  #   description: Internal services
